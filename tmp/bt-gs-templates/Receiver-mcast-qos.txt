!Done

class-of-service {

forwarding-classes {
        class FC-Q0 queue-num 0;
        class FC-Q1 queue-num 1;
        class FC-Q2 queue-num 2;
        class FC-Q3 queue-num 3;
        class FC-Q4 queue-num 4;
        class FC-Q5 queue-num 5;
        class FC-Q6 queue-num 6;
        class FC-Q7 queue-num 7;
}

}

policy-options {
    prefix-list $multicast_client_vrf_name$-src-1a {
        $prefix1/$prefix1_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-1a {
        $prefix2/$prefix2_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-1b {
        $prefix3/$prefix3_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-1b {
        $prefix4/$prefix4_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-1c {
        $prefix5/$prefix5_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-1c {
        $prefix6/$prefix6_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-2a {
        $prefix7/$prefix7_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-2a {
        $prefix8/$prefix8_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-2b {
        $prefix9/$prefix9_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-2b {
        $prefix10/$prefix10_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-2c {
        $prefix11/$prefix11_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-2c {
        $prefix12/$prefix12_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-3a {
        $prefix13/$prefix13_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-3a {
        $prefix14/$prefix14_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-3b {
        $prefix15/$prefix15_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-3b {
        $prefix16/$prefix16_mask;
    }
    prefix-list $multicast_client_vrf_name$-src-3c {
        $prefix17/$prefix17_mask;
    }
    prefix-list $multicast_client_vrf_name$-mcast-3c {
        $prefix18/$prefix18_mask;
    }
}



firewall {
  family inet {
    filter fwd_table_$multicast_client_vrf_name$ {
        term mcast-serv-1a {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1a;
                }                       
            }
            then {
                policer police_100k_unltd_burst;
                count mcast-serv-1;
                loss-priority low;
                forwarding-class FC-Q7;
                next term
            }
        }
        term mcast-serv-1b {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1b;
                }                       
            }
            then {
                policer police_100k_unltd_burst;
                count mcast-serv-1;
                loss-priority low;
                forwarding-class FC-Q7;
                next term
            }
        }
        term mcast-serv-1c {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1c;
                }                       
            }
            then {
                policer police_100k_unltd_burst;
                count mcast-serv-1;
                loss-priority low;
                forwarding-class FC-Q7;
                next term
            }
        }
        term mcast-serv-1a-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1a;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-1_mcast-plp-low;
                accept
            }
        }
        term mcast-serv-1b-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1b;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-1_mcast-plp-low;
                accept
            }
        }
        term mcast-serv-1c-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1c;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-1_mcast-plp-low;
                accept
            }
        }
        term mcast-serv-1a-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1a;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-1-plp-high;
                accept
            }
        }
        term mcast-serv-1b-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1b;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-1-plp-high;
                accept
            }
        }
        term mcast-serv-1c-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-1c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-1c;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-1-plp-high;
                accept
            }
        }
        term mcast-serv-2a {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2a;
                }
            }
            then {
                policer police_2m_unltd_burst;
                count mcast-serv-2;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-2b {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2b;
                }
            }
            then {
                policer police_2m_unltd_burst;
                count mcast-serv-2;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-2c {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2c;
                }
            }
            then {
                policer police_2m_unltd_burst;
                count mcast-serv-2;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-2a-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2a;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-2-plp-low;
                accept
            }
        }
        term mcast-serv-2b-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2b;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-2-plp-low;
                accept
            }
        }
        term mcast-serv-2c-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2c;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-2-plp-low;
                accept
            }
        }
        term mcast-serv-2a-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2a;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-2-plp-high;
                accept
            }
        }
        term mcast-serv-2b-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2b;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-2-plp-high;
                accept
            }
        }
        term mcast-serv-2c-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-2c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-2c;
                }
                loss-priority high;                      
            }
            then {
                count mcast-serv-2-plp-high;
                accept
            }
        }
        term mcast-serv-3a {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3a;
                }
            }
            then {
                policer police_20m_unltd_burst;
                count mcast-serv-3;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-3b {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3b;
                }
            }
            then {
                policer police_20m_unltd_burst;
                count mcast-serv-3;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-3c {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3c;
                }
            }
            then {
                policer police_20m_unltd_burst;
                count mcast-serv-3;
                loss-priority low;
                forwarding-class FC-Q7;
                next term;
            }
        }
        term mcast-serv-3a-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3a;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-3-plp-low;
                accept
            }
        }
        term mcast-serv-3b-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3b;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-3-plp-low;
                accept
            }
        }
        term mcast-serv-3c-plp-low {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3c;
                }                 
                loss-priority low;      
            }
            then {
                count mcast-serv-3-plp-low;
                accept
            }
        }
        term mcast-serv-3a-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3a;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3a;
                }
                loss-priority high;                      
            }
            then {
                count nmcast-serv-3-plp-high;
                accept
            }
        }
        term mcast-serv-3b-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3b;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3b;
                }
                loss-priority high;                      
            }
            then {
                count nmcast-serv-3-plp-high;
                accept
            }
        }
        term mcast-serv-3c-plp-high {
            from {
                source-prefix-list {
                    $multicast_client_vrf_name$-src-3c;
                }
                destination-prefix-list {
                    $multicast_client_vrf_name$-mcast-3c;
                }
                loss-priority high;                      
            }
            then {
                count nmcast-serv-3-plp-high;
                accept
            }
        }
        term rest {
            then accept;
        }
    }
    }
    policer police_100k_unltd_burst {
    		filter-specific;
        if-exceeding {
            bandwidth-limit 100k;
            burst-size-limit 15000;     
        }
        then loss-priority high;;
    }
    policer police_2m_unltd_burst {
    		filter-specific;
        if-exceeding {
            bandwidth-limit 2m;
            burst-size-limit 15000;     
        }
        then loss-priority high;;
    }
    policer police_20m_unltd_burst {
    		filter-specific;
        if-exceeding {
            bandwidth-limit 20m;
            burst-size-limit 15000;     
        }
        then loss-priority high;;
    }
}


routing-instances {
    $multicast_client_vrf_name$ {
        forwarding-options {
            family inet {
                filter {
                    output fwd_table_$multicast_client_vrf_name$;
                }
            }
        }
    }
}

