## Last commit: 2010-07-13 10:14:27 UTC by dgethings
version 10.2R1.8;
groups {
    allow-vrf-martians {
        routing-instances {
            <*> {
                routing-options {
                    martians {
                        0.0.0.0/8 orlonger allow;
                        127.0.0.0/8 orlonger allow;
                        128.0.0.0/16 orlonger allow;
                        191.255.0.0/16 orlonger allow;
                        192.0.0.0/24 orlonger allow;
                        223.255.255.0/24 orlonger allow;
                        240.0.0.0/8 orlonger allow;
                    }
                }
            }
        }
    }
    re0 {
        system {
            host-name vega-re0;
            radius-server {
                172.30.155.131 source-address 172.30.155.149;
            }
            ntp {
                source-address 172.30.155.149;
            }
        }
        interfaces {
            fxp0 {
                unit 0 {
                    family inet {
                        address 172.30.155.149/24;
                        address 172.30.155.151/24 {
                            master-only;
                        }
                    }
                }
            }
        }
    }
    re1 {
        system {
            host-name vega-re1;
            radius-server {
                172.30.155.131 source-address 172.30.155.150;
            }
            ntp {
                source-address 172.30.155.150;
            }
        }
        interfaces {
            fxp0 {
                unit 0 {
                    family inet {
                        address 172.30.155.151/24 {
                            master-only;
                        }
                        address 172.30.155.150/24;
                    }
                }
            }
        }
    }
    lab {
        system {
            domain-name jtac-emea.jnpr.net;
            domain-search [ jtac-emea.jnpr.net jnpr.net ];
            backup-router 172.30.155.1 destination 172.16.0.0/12;
            radius-server {
                172.30.155.131 {
                    port 1812;
                    secret "$9$RypcSe8X-YgoKM87dV4oQF3/p0IEc"; ## SECRET-DATA
                }
            }
            login {
                user remote {
                    uid 2002;
                    class super-user;
                }
                user lab {
                    uid 2001;
                    class super-user;
                    authentication {
                        encrypted-password "$1$51XEVtmi$KF/awz9D3OrZXAgkJxh0u."; ## SECRET-DATA
                    }
                }
            }
            services {
                ftp;
                ssh;
                netconf {
                    ssh;
                }
                outbound-ssh {
                    client 000C29EDA63E {
                        device-id 5F8945;
                        secret "$9$DGHP5/CtIRc0OhyKMXxbwYgZU"; ## SECRET-DATA
                        services netconf;
                        172.30.155.152 port 7804;
                    }
                }
            }
            ntp {
                boot-server 172.30.155.131;
                server 172.30.155.131 prefer;
            }
        }
        interfaces {
            so-7/1/0 {
                description crux:so-1/1;
            }
            ge-9/0/1 {
                description hydra:ge-9/0/1;
            }
            ge-9/0/2 {
                description hydra:ge-9/0/2;
            }
            ge-9/0/5 {
                description gemini:ge-0/1/2;
            }
            ge-9/0/9 {
                description PS_LAB:T18.06.2;
            }
            ge-9/1/0 {
                description bellatrix:ge-0/0/11;
            }
            ge-9/1/1 {
                description hydra:ge-9/1/1;
            }
            ge-9/1/5 {
                description gemini:ge-0/1/3;
            }
            ge-9/1/9 {
                description bellatrix:ge-0/0/15;
            }
            xe-9/2/0 {
                description crux:4/2;
            }
            xe-9/3/0 {
                description hydra:xe-9/3/0;
            }
            ge-9/0/6 {
                description polaris:ge-0/1/4;
            }
            ge-9/1/6 {
                description polaris:ge-0/1/5;
            }
            ge-9/0/0 {
                description bellatrix:ge-0/0/13;
            }
        }
        routing-options {
            static {
                route 172.16.0.0/12 {
                    next-hop 172.30.155.1;
                    retain;
                    no-readvertise;
                }
            }
        }
    }
}
apply-groups [ allow-vrf-martians re0 re1 lab ];
system {
    domain-name jtac-emea.jnpr.net;
    time-zone UTC;
    inactive: default-address-selection;
    no-redirects;
    internet-options {
        tcp-drop-synfin-set;
    }
    authentication-order [ radius password ];
    ports {
        console {
            log-out-on-disconnect;
            type vt100;
        }
        auxiliary insecure;
    }
    root-authentication {
        encrypted-password "$1$maPAXuaQ$PVJqIaAMoiX18IHpcXY4Q0"; ## SECRET-DATA
    }
    name-server {
        172.30.155.131;
    }
    accounting {
        events [ login change-log interactive-commands ];
        destination {
            radius {
                server {
                    172.30.155.131 secret "$9$JSZjqmPQ3nCq.0BEhrl"; ## SECRET-DATA
                }
            }
        }
    }
    login {
        message "\nBritish Telecommunications plc\n\nWARNING: You have accessed a network device operated by BT. You are required\nto have a personal authorisation from the system administrator before you use\nthis computer and you are strictly limited to the use set out in that written\nauthorisation. Unauthorised access to or misuse of this system is prohibited\nand may constitute an offence under the Computer Misuse Act 1990.\n\nIf you disclose any information obtained through this system without authority\nBT will take appropriateaction against you. This may include legal\nproceedings, prosecution and disciplinary action up to and including\ndismissal.\n\n";
        retry-options {
            tries-before-disconnect 3;
        }
        class ro-group {
            idle-timeout 30;
            permissions view;
        }
        class su-group {
            idle-timeout 30;
            permissions all;
        }
        user read {
            full-name "TACACS+ authenticated read-only";
            uid 2005;
            class ro-group;
            authentication {
                encrypted-password "$1$qVafvXvL$OUT5MIWst1L.IQGKEuJvi."; ## SECRET-DATA
            }
        }
        user write {
            full-name "TACACS+ authenticated superuser";
            uid 2007;
            class su-group;
            authentication {
                encrypted-password "$1$lQCKfPTl$eu2M8SohHdMnTyCslRowu/"; ## SECRET-DATA
            }
        }
    }
    services {
        telnet {
            connection-limit 16;
            rate-limit 16;
        }
    }
    syslog {
        archive size 1m files 10;
        user * {
            any critical;
        }
        host 172.30.155.131 {
            any notice;
            daemon info;
            facility-override local7;
            log-prefix Juniper;
        }
        host other-routing-engine {
            any error;
            log-prefix OTHER-RE;
        }
        file messages {
            any warning;
            authorization none;
            archive world-readable;
        }
        file syslog {
            any info;
            firewall none;
            archive size 5m files 5;
        }
        file security {
            authorization notice;
        }
        file commands {
            interactive-commands info;
        }
        file firewall-filter-log {
            firewall any;
        }
        console {
            any critical;
        }
        time-format year millisecond;
    }
    compress-configuration-files;
    commit synchronize;
    ntp {
        boot-server 172.30.155.131;
        server 172.30.155.131 prefer;
    }
}
chassis {
    redundancy {
        failover {
            on-loss-of-keepalives;
            on-disk-failure;
        }
        graceful-switchover;
    }
    fpc 7 {
        pic 0 {
            traffic-manager {
                egress-shaping-overhead 20;
                mode egress-only;
            }
            max-queues-per-interface 8;
        }
    }
    fpc 9 {
        pic 0 {
            tunnel-services {
                bandwidth 1g;
            }
            traffic-manager {
                egress-shaping-overhead 20;
                mode egress-only;
            }
            max-queues-per-interface 8;
        }
        pic 1 {
            tunnel-services {
                bandwidth 1g;
            }
            traffic-manager {
                egress-shaping-overhead 20;
                mode egress-only;
            }
            max-queues-per-interface 8;
        }
        pic 2 {
            traffic-manager {
                egress-shaping-overhead 20;
                mode egress-only;
            }
            max-queues-per-interface 8;
        }
        pic 3 {
            traffic-manager {
                egress-shaping-overhead 20;
                mode egress-only;
            }
            max-queues-per-interface 8;
        }
    }
    inactive: alarm {
        management-ethernet {
            link-down ignore;
        }
    }
}
interfaces {
    ge-9/0/5 {
        traps;
        vlan-tagging;
        mtu 1718;
        hold-time up 2000 down 0;
        unit 15 {
            description "white vlan";
            vlan-id 15;
            family inet {
                mtu 1688;
                address 10.23.15.2/30;
            }
            family mpls {
                mtu 1700;
            }
        }
        unit 65 {
            description "red vlan";
            vlan-id 65;
            family inet {
                mtu 1500;
                address 10.23.65.2/30;
            }
            family mpls {
                mtu 1552;
            }
        }
        unit 75 {
            description "blue vlan";
            vlan-id 75;
            family inet {
                mtu 1500;
                address 10.23.75.2/30;
            }
            family mpls {
                mtu 1552;
            }
        }
    }
    ge-9/0/6 {
        traps;
        vlan-tagging;
        mtu 1718;
        hold-time up 2000 down 0;
        unit 15 {
            description "white vlan";
            vlan-id 15;
            family inet {
                mtu 1688;
                address 10.25.15.2/30;
            }
            family mpls {
                mtu 1700;
            }
        }
        unit 65 {
            description "red vlan";
            vlan-id 65;
            family inet {
                mtu 1500;
                address 10.25.65.2/30;
            }
            family mpls {
                mtu 1552;
            }
        }
        unit 75 {
            description "blue vlan";
            vlan-id 75;
            family inet {
                mtu 1500;
                address 10.25.75.2/30;
            }
            family mpls {
                mtu 1552;
            }
        }
    }
    lo0 {
        unit 0 {
            family inet {
                filter {
                    input protect-RE;
                    output RSVP-rate-limit;
                }
                address 127.0.0.1/32;
                address 192.168.0.4/32 {
                    preferred;
                }
            }
        }
        unit 200 {
            description "dummy vrf loopback";
            family inet {
                address 192.168.204.0/32;
            }
        }
    }
}
forwarding-options {
    hash-key {
        family mpls {
            label-1;
            label-2;
            payload {
                ip {
                    layer-3-only;
                }
            }
        }
    }
}
event-options {
    policy PIM-Neighbour-Changes {
        events [ rpd_pim_nbrdown rpd_pim_nbrup ];
        then {
            raise-trap;
        }
    }
    policy OSPF-LDP-Loss-of-Sychronisation {
        events rpd_ospf_ldp_sync;
        then {
            raise-trap;
        }
    }
    policy LDP-Adjacency-Changes {
        events [ rpd_ldp_nbrdown rpd_ldp_nbrup ];
        then {
            raise-trap;
        }
    }
}
snmp {
    location Amsterdam;
    contact "David Gethings <dgethings@juniper.net>";
    view QuebecROView {
        oid ifMIB include;
        oid jnxCos include;
        oid 1.3.6.1.2.1 include;
        oid jnxFWCounter include;
        oid jnxRpmMib include;
        oid jnxBoxAnatomy include;
        oid jnxFirewallCounterTable include;
    }
    view novacm {
        oid internet include;
        oid internet.6.3.15 exclude;
        oid internet.6.3.16 exclude;
        oid internet.6.3.18 exclude;
    }
    view SmartsROView {
        oid 1.3.6.1.2.1 include;
        oid 1.3.6.1.3.96 include;
        oid 1.3.6.1.3.118 include;
        oid 1.3.6.1.4.1.9.9 include;
        oid 1.3.6.1.4.1.9.2 include;
        oid 1.3.6.1.4.1.2636 include;
        oid 1.3.6.1.2.1.15 include;
        oid 1.3.6.1.2.1.14 include;
        oid 1.3.6.1.2.1.10.166.2 include;
    }
    view NOC_controlled_RO {
        oid internet include;
    }
    view CMMROView {
        oid 1.3.6.1.2.1.2 include;
        oid 1.3.6.1.2.1.1.2 include;
        oid 1.3.6.1.2.1.1.3 include;
        oid 1.3.6.1.2.1.1.5 include;
        oid 1.3.6.1.2.1.1.1 include;
        oid 1.3.6.1.3.61 include;
        oid 1.3.6.1.2.1.83 include;
        oid 1.3.6.1.2.1.85 include;
        oid 1.3.6.1.3.92 include;
        oid 1.3.6.1.4.1.9.5.0 include;
        oid 1.3.6.1.3.118 include;
        oid 1.3.6.1.4.1.9.10.113 include;
        oid 1.3.6.1.2.1.4.20.1 include;
    }
    view BTIROView {
        oid 1.3.6.1.2.1 include;
        oid jnxCos include;
        oid jnxFirewallCounterTable include;
    }
    view CABLEDOCSISROView {
        oid internet include;
    }
    community cable-docsis {
        view CABLEDOCSISROView;
        authorization read-only;
        clients {
            0.0.0.0/0 restrict;
        }
    }
    community Quebec_RO_string {
        view QuebecROView;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community Smarts_core_RO_string {
        view SmartsROView;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community concord_ehealth_string {
        view NOC_controlled_RO;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community public {
        view novacm;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community CMM_RO_string {
        view CMMROView;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community BTI_RO_string {
        view BTIROView;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    community public2 {
        view NOC_controlled_RO;
        authorization read-only;
        clients {
            172.30.155.0/24;
        }
    }
    trap-options {
        source-address lo0;
    }
    trap-group PE_router_SNMP_group {
        version v1;
        categories {
            chassis;
            link;
            routing;
            startup;
            rmon-alarm;
            configuration;
            sonet-alarms;
        }
        targets {
            172.30.155.131;
            172.30.155.153;
        }
    }
    trap-group Smarts_core_RO_string {
        version v2;
        categories {
            chassis;
            link;
            routing;
            startup;
            rmon-alarm;
            configuration;
            sonet-alarms;
        }
        targets {
            172.30.155.131;
            172.30.155.153;
        }
    }
}
routing-options {
    l3vpn-composite-nexthop;
    nonstop-routing;
    static {
        route 127.0.0.0/24 receive;
        route 192.168.1.4/32 receive;
        route 192.168.2.4/32 receive;
    }
    martians {
        127.0.0.0/24 orlonger allow;
    }
    aggregate {
        route 7.0.0.0/24;
    }
    rib-groups {
        daf-red {
            import-rib [ red.inet.0 inet.0 ];
        }
        daf-blue {
            import-rib [ blue.inet.0 inet.0 ];
        }
    }
    router-id 192.168.0.4;
    autonomous-system 12641;
    forwarding-table {
        export load-balancing-policy;
        indirect-next-hop;
    }
    multicast {
        ssm-groups 232.232.0.0/16;
    }
}
protocols {
    rsvp {
        interface fxp0.0 {
            disable;
        }
        interface ge-9/0/6.15 {
            bandwidth 12m;
        }
        interface ge-9/0/5.15 {
            bandwidth 12m;
        }
    }
    mpls {
        no-propagate-ttl;
        icmp-tunneling;
        interface ge-9/0/6.15;
        interface ge-9/0/5.15;
    }
    bgp {
        path-selection always-compare-med;
        log-updown;
        damping;
        group RR-group {
            type internal;
            local-address 192.168.0.4;
            out-delay 1;
            log-updown;
            import bgp-policies-RR-group-import;
            family inet-vpn {
                unicast;
            }
            export [ bgp-redistributes SET-NEXT-HOP ];
            neighbor 192.168.100.1 {
                authentication-key "$9$C0s/pORreW-VYhSVYgojiAp0BhSlKMXNd"; ## SECRET-DATA
            }
        }
    }
    ospf {
        spf-options {
            delay 400;
            holddown 5000;
            rapid-runs 10;
        }
        area 0.0.0.5 {
            interface lo0.0 {
                passive;
            }
            interface ge-9/0/6.15 {
                interface-type p2p;
                metric 10;
                priority 0;
                ldp-synchronization;
                hello-interval 10;
                dead-interval 40;
                authentication {
                    md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                }
                bfd-liveness-detection {
                    minimum-interval 300;
                    multiplier 3;
                    no-adaptation;
                }
            }
            interface ge-9/0/5.15 {
                interface-type p2p;
                metric 10;
                priority 0;
                ldp-synchronization;
                hello-interval 10;
                dead-interval 40;
                authentication {
                    md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                }
                bfd-liveness-detection {
                    minimum-interval 300;
                    multiplier 3;
                    no-adaptation;
                }
            }
        }
    }
    ldp {
        track-igp-metric;
        strict-targeted-hellos;
        egress-policy RED-BLUE-ACL1;
        deaggregate;
        keepalive-interval 60;
        keepalive-timeout 180;
        interface ge-9/0/5.15;
        interface ge-9/0/5.65;
        interface ge-9/0/5.75;
        interface ge-9/0/6.15;
        interface ge-9/0/6.65;
        interface ge-9/0/6.75;
        interface all;
        interface fxp0.0 {
            disable;
        }
        igp-synchronization holddown-interval 20;
    }
    pim {
        interface ge-9/0/6.15 {
            mode sparse;
            priority 0;
            version 2;
        }
        interface ge-9/0/6.65 {
            mode sparse;
            priority 0;
            version 2;
        }
        interface ge-9/0/6.75 {
            mode sparse;
            priority 0;
            version 2;
        }
        interface ge-9/0/5.15 {
            mode sparse;
            priority 0;
            version 2;
        }
        interface ge-9/0/5.65 {
            mode sparse;
            priority 0;
            version 2;
        }
        interface ge-9/0/5.75 {
            mode sparse;
            priority 0;
            version 2;
        }
    }
}
policy-options {
    prefix-list ACL-8-loopback200 {
        192.168.200.0/21;
        192.168.208.0/20;
        192.168.224.0/19;
    }
    prefix-list ACL-11-CE-mgmt-loopbacks {
        192.168.100.0/22;
        192.168.104.0/21;
        192.168.112.0/20;
        192.168.128.0/18;
        192.168.192.0/21;
    }
    prefix-list dns-addresses {
        apply-path "system name-server <*>";
    }
    prefix-list ftp-addresses {
        172.30.155.0/24;
    }
    prefix-list localhost {
        127.0.0.1/32;
    }
    prefix-list ntp-addresses {
        172.30.155.131/32;
        apply-path "interfaces lo0 unit 0 family inet address <*>";
    }
    prefix-list snmp-addresses {
        172.30.155.0/24;
    }
    prefix-list tacacs-addresses {
        172.30.155.0/24;
    }
    prefix-list telnet-addresses {
        172.16.0.0/12;
    }
    prefix-list loopback100 {
        62.6.2.0/24;
        62.6.10.0/24;
        62.6.18.0/23;
        62.6.70.0/24;
        62.6.88.0/24;
        62.6.90.0/24;
        62.6.99.0/25;
        212.21.216.0/24;
        212.31.213.0/24;
        212.31.220.0/24;
        217.32.138.0/24;
        217.46.8.0/24;
        217.46.10.0/24;
    }
    prefix-list loopback60 {
        62.6.21.0/24;
        62.6.101.0/24;
        217.46.16.0/24;
        217.46.18.0/24;
        217.46.19.0/24;
    }
    prefix-list loopback70 {
        62.6.5.0/24;
        62.6.11.0/24;
        62.6.22.0/24;
        212.21.218.0/24;
        217.46.17.0/24;
    }
    prefix-list ACL-13-cascaded-mgmt {
        192.168.100.0/22;
        192.168.104.0/21;
        192.168.112.0/20;
        192.168.128.0/18;
        192.168.192.0/21;
    }
    prefix-list ACL-30-bt-nmc-mgmt {
        62.6.69.88/29;
        62.6.69.96/29;
        62.6.69.112/28;
        62.6.69.128/28;
        62.80.64.0/24;
        62.80.66.128/28;
        62.134.38.0/25;
        62.239.34.0/24;
        62.239.35.98/31;
        62.239.35.128/27;
        81.146.75.0/27;
        147.149.52.0/24;
        147.150.52.0/24;
        147.151.39.224/27;
        147.151.61.0/25;
        147.151.77.0/24;
        147.151.102.0/24;
        147.151.107.0/24;
        147.151.170.0/24;
        147.151.204.0/24;
        147.151.205.0/24;
        162.54.52.0/24;
        168.125.7.0/28;
        168.125.7.212/32;
        168.125.240.0/23;
        193.113.36.0/24;
        193.203.132.0/28;
        194.72.6.64/27;
        194.72.6.112/28;
        194.72.6.176/29;
        194.72.6.208/28;
        194.74.74.160/27;
        194.74.74.195/32;
        194.74.75.0/24;
        194.74.76.32/27;
        194.74.80.0/24;
        194.74.81.89/32;
        194.102.6.0/24;
        194.102.7.133/32;
        194.102.7.141/32;
        194.102.19.0/24;
        195.100.115.0/28;
        195.171.36.64/27;
        195.182.110.224/27;
        195.182.112.192/26;
        195.182.114.192/27;
        212.31.215.192/28;
        212.31.215.240/28;
        212.162.213.229/32;
        212.162.213.241/32;
        213.194.52.64/28;
        217.32.105.96/27;
        217.35.209.64/26;
        217.35.209.202/32;
    }
    prefix-list ACL-122-bt-nmc-mgmt {
        62.6.69.88/29;
        62.6.69.96/29;
        62.6.69.112/28;
        62.6.69.128/28;
        62.80.64.0/24;
        62.80.66.128/28;
        62.134.38.0/25;
        62.239.34.0/24;
        62.239.35.98/31;
        62.239.35.128/27;
        81.146.75.0/27;
        147.149.52.0/24;
        147.150.52.0/24;
        147.151.39.224/27;
        147.151.61.0/25;
        147.151.77.0/24;
        147.151.102.0/24;
        147.151.107.0/24;
        147.151.170.0/24;
        147.151.204.0/24;
        147.151.205.0/24;
        162.54.52.0/24;
        168.125.7.0/28;
        168.125.7.212/32;
        168.125.240.0/23;
        193.113.36.0/24;
        193.203.132.0/28;
        194.72.6.64/27;
        194.72.6.112/28;
        194.72.6.176/29;
        194.72.6.208/28;
        194.74.74.160/27;
        194.74.74.195/32;
        194.74.75.0/24;
        194.74.76.32/27;
        194.74.80.0/24;
        194.74.81.89/32;
        194.102.6.0/24;
        194.102.7.133/32;
        194.102.7.141/32;
        194.102.19.0/24;
        195.100.115.0/28;
        195.171.36.64/27;
        195.182.110.224/27;
        195.182.112.192/26;
        195.182.114.192/27;
        212.31.215.192/28;
        212.31.215.240/28;
        212.162.213.229/32;
        212.162.213.241/32;
        213.194.52.64/28;
        217.32.105.96/27;
        217.35.209.64/26;
        217.35.209.202/32;
    }
    prefix-list ACL-123-bt-nmc-mgmt {
        62.6.69.88/29;
        62.6.69.96/29;
        62.6.69.112/28;
        62.6.69.128/28;
        62.80.64.0/24;
        62.80.66.128/28;
        62.134.38.0/25;
        62.239.34.0/24;
        62.239.35.98/31;
        62.239.35.128/27;
        81.146.75.0/27;
        147.149.52.0/24;
        147.150.52.0/24;
        147.151.39.224/27;
        147.151.61.0/25;
        147.151.77.0/24;
        147.151.102.0/24;
        147.151.107.0/24;
        147.151.170.0/24;
        147.151.204.0/24;
        147.151.205.0/24;
        162.54.52.0/24;
        168.125.7.0/28;
        168.125.7.212/32;
        168.125.240.0/23;
        193.113.36.0/24;
        193.203.132.0/28;
        194.72.6.64/27;
        194.72.6.112/28;
        194.72.6.176/29;
        194.72.6.208/28;
        194.74.74.160/27;
        194.74.74.195/32;
        194.74.75.0/24;
        194.74.76.32/27;
        194.74.80.0/24;
        194.74.81.89/32;
        194.102.6.0/24;
        194.102.7.133/32;
        194.102.7.141/32;
        194.102.19.0/24;
        195.100.115.0/28;
        195.171.36.64/27;
        195.182.110.224/27;
        195.182.112.192/26;
        195.182.114.192/27;
        212.31.215.192/28;
        212.31.215.240/28;
        212.162.213.229/32;
        212.162.213.241/32;
        213.194.52.64/28;
        217.32.105.96/27;
        217.35.209.64/26;
        217.35.209.202/32;
    }
    prefix-list deny-unb-unn-src-n-dst {
        62.6.69.88/29;
        62.6.69.112/28;
        62.6.69.128/28;
        62.80.64.0/24;
        62.80.66.128/28;
        62.134.38.0/25;
        81.146.75.0/27;
        147.149.52.0/24;
        147.150.52.0/24;
        147.151.39.224/27;
        147.151.61.0/25;
        147.151.77.0/24;
        147.151.102.0/24;
        147.151.107.0/24;
        147.151.170.0/24;
        147.151.204.0/24;
        147.151.205.0/24;
        168.125.7.0/28;
        168.125.240.0/23;
        172.31.31.128/25;
        193.113.36.0/24;
        193.203.132.0/28;
        194.74.80.0/24;
        195.100.115.0/28;
        195.171.36.64/27;
        195.182.110.224/27;
        195.182.112.192/26;
        195.182.114.192/27;
        213.194.52.64/28;
    }
    prefix-list deny-unb-unn-dst {
        62.102.96.0/23;
        62.102.98.0/23;
        208.163.212.0/23;
        208.163.218.0/23;
        208.163.222.0/23;
        210.7.129.0/24;
        210.7.130.0/23;
        212.31.214.0/24;
        212.31.215.0/25;
    }
    prefix-list ams-mgt-addr {
        212.31.215.240/28;
    }
    prefix-list ams-mgt2-addr {
        212.31.215.192/28;
    }
    prefix-list tfp-mgt-addr {
        162.54.52.0/24;
    }
    prefix-list ble-mgt-addr {
        62.6.69.96/29;
    }
    prefix-list atl-sdm-addr {
        168.125.7.212/32;
    }
    prefix-list tacacs-server1 {
        194.74.81.89/32;
    }
    prefix-list tacacs-server2 {
        212.162.213.241/32;
    }
    prefix-list ssh-addresses {
        172.16.0.0/12;
    }
    policy-statement Australasia-hub-policy {
        term Australasia-hub-rt {
            from community Australasia-hub-rt;
            then accept;
        }
    }
    policy-statement BLUE-CORE-DIVERSITY {
        term term-1 {
            from community [ community-BLUE-CORE-DIVERSITY-1 community-BLUE-CORE-DIVERSITY-2 ];
            then accept;
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement Belgium-hub-policy {
        term Belgium-hub-rt {
            from community Belgium-hub-rt;
            then accept;
        }
    }
    policy-statement CLEARINTERNALCOMM {
        term PE-VRF-loopbacks {
            from {
                protocol bgp;
                community [ BT-MPLS-PE-VRF-loopback UK-MPLS-PE-VRF-loopback ];
            }
            then reject;
        }
        term redis-static {
            from protocol static;
            then accept;
        }
        term clear-BT-communities {
            from protocol bgp;
            then {
                community delete BT-MPLS-customer-prefixes;
                community delete UK-MPLS-customer-prefixes;
                community delete all-RTs;
                community delete all-Origins;
                next term;
            }
        }
    }
    policy-statement CONNECTED-CONTAIN {
        term term-4 {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then {
                community set CONNECTED-CONTAIN-1;
                accept;
            }
        }
    }
    policy-statement CUSTOMER-BGP-DAMPING {
        term bgp-damping-policy {
            from policy bgp-damping-policy;
            then next term;
        }
        term evaluate-next {
            then next policy;
        }
    }
    policy-statement DEFAULTCEPEER {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term last {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                next term;
            }
        }
    }
    policy-statement DEFAULTSTATIC {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                protocol static;
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then {
                community set BT-MPLS-NMC-mgmt-SET;
                accept;
            }
        }
        term tag-6121 {
            from {
                protocol static;
                tag 6121;
            }
            then {
                community set BT-MPLS-blue-core-active-SET;
                community add Reuters-NAT-SET;
                accept;
            }
        }
        term tag-6122 {
            from {
                protocol static;
                tag 6122;
            }
            then {
                community set BT-MPLS-red-core-active-SET;
                community add Reuters-NAT-SET;
                accept;
            }
        }
        term tag-6123 {
            from {
                protocol static;
                tag 6123;
            }
            then {
                community set BT-MPLS-blue-core-diverse-SET;
                accept;
            }
        }
        term tag-6124 {
            from {
                protocol static;
                tag 6124;
            }
            then {
                community set BT-MPLS-red-core-diverse-SET;
                accept;
            }
        }
        term tag-6137 {
            from {
                protocol static;
                tag 6137;
            }
            then {
                community set Reuters-NAT-SET;
                accept;
            }
        }
    }
    policy-statement DENYBTPREFIX {
        term BT-private-prefixes {
            from {
                protocol bgp;
                community [ BT-MPLS-routes-wildcard UK-MPLS-routes-wildcard ];
            }
            then reject;
        }
        term redis-static {
            from protocol static;
            then accept;
        }
        term clear-BT-communities {
            from protocol bgp;
            then {
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete all-RTs;
                community delete all-Origins;
                next term;
            }
        }
    }
    policy-statement France-hub-policy {
        term France-hub-rt {
            from community France-hub-rt;
            then accept;
        }
    }
    policy-statement GCSC-Amsterdam-hub-policy {
        term GCSC-Amsterdam-hub-rt {
            from community GCSC-Amsterdam-hub-rt;
            then accept;
        }
    }
    policy-statement IMPORT-BTMPLS-MD-GW1 {
        term BT-MPLS-GW1 {
            from {
                protocol bgp;
                community BTMPLS-MD-GW1;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORT-BTMPLS-MD-GW2 {
        term BT-MPLS-GW2 {
            from {
                protocol bgp;
                community BTMPLS-MD-GW2;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORT-BTMPLS-MD-GW3 {
        term BT-MPLS-GW3 {
            from {
                protocol bgp;
                community BTMPLS-MD-GW3;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORT-BTMPLS-MD-GW4 {
        term BT-MPLS-GW4 {
            from {
                protocol bgp;
                community BTMPLS-MD-GW4;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORT-BTMPLS-MD-GW5 {
        term BT-MPLS-GW5 {
            from {
                protocol bgp;
                community BTMPLS-MD-GW5;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-AMH-TFP-EU {
        term INTGW-A-AMH-EU {
            from {
                protocol bgp;
                community INTGW-A-AMH-EU;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-A-TFP-EU {
            from {
                protocol bgp;
                community INTGW-A-TFP-EU;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-SGP-SPT-AP {
        term INTGW-A-SGP-AP {
            from {
                protocol bgp;
                community INTGW-A-SGP-AP;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-A-SPT-AP {
            from {
                protocol bgp;
                community INTGW-A-SPT-AP;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-SNJ-STI-US {
        term INTGW-A-SNJ-US {
            from {
                protocol bgp;
                community INTGW-A-SNJ-US;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-A-STI-US {
            from {
                protocol bgp;
                community INTGW-A-STI-US;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-SPT-SGP-AP {
        term INTGW-A-SGP-AP {
            from {
                protocol bgp;
                community INTGW-A-SGP-AP;
            }
            then {
                preference 169;
                accept;
            }
        }
        term INTGW-A-SPT-AP {
            from {
                protocol bgp;
                community INTGW-A-SPT-AP;
            }
            then {
                preference 168;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-STI-SNJ-US {
        term INTGW-A-STI-US {
            from {
                protocol bgp;
                community INTGW-A-STI-US;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-A-SNJ-US {
            from {
                protocol bgp;
                community INTGW-A-SNJ-US;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-A-TFP-AMH-EU {
        term INTGW-A-TFP-EU {
            from {
                protocol bgp;
                community INTGW-A-TFP-EU;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-A-AMH-EU {
            from {
                protocol bgp;
                community INTGW-A-AMH-EU;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-B-FRK-STK-EU {
        term INTGW-B-FRK-EU {
            from {
                protocol bgp;
                community INTGW-B-FRK-EU;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-B-STK-EU {
            from {
                protocol bgp;
                community INTGW-B-STK-EU;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement IMPORTINTGW-B-STK-FRK-EU {
        term INTGW-B-STK-EU {
            from {
                protocol bgp;
                community INTGW-B-STK-EU;
            }
            then {
                preference 168;
                accept;
            }
        }
        term INTGW-B-FRK-EU {
            from {
                protocol bgp;
                community INTGW-B-FRK-EU;
            }
            then {
                preference 169;
                accept;
            }
        }
    }
    policy-statement Irish-hub-policy {
        term Irish-hub-rt {
            from community Irish-hub-rt;
            then accept;
        }
    }
    policy-statement NAMngt-hub-policy {
        term NAMngt-hub-rt {
            from community NAMngt-hub-rt;
            then accept;
        }
    }
    policy-statement Netherlands-mgnt-hub-policy {
        term Netherlands-mgnt-hub-rt {
            from community Netherlands-mgnt-hub-rt;
            then accept;
        }
    }
    policy-statement RED-BLUE-ACL1 {
        term term-1 {
            from {
                route-filter 192.168.0.4/32 exact;
                route-filter 192.168.1.4/32 exact;
                route-filter 192.168.2.4/32 exact;
            }
            then accept;
        }
    }
    policy-statement RED-CORE-DIVERSITY {
        term term-1 {
            from community [ community-RED-CORE-DIVERSITY-1 community-RED-CORE-DIVERSITY-2 ];
            then accept;
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement SET-COMMUNITY-GW1 {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term set-gw-community {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                community add BTMPLS-MD-GW1-SET;
                next term;
            }
        }
    }
    policy-statement SET-COMMUNITY-GW2 {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term set-gw-community {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                community add BTMPLS-MD-GW2-SET;
                next term;
            }
        }
    }
    policy-statement SET-COMMUNITY-GW3 {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term set-gw-community {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                community add BTMPLS-MD-GW3-SET;
                next term;
            }
        }
    }
    policy-statement SET-COMMUNITY-GW4 {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term set-gw-community {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                community add BTMPLS-MD-GW4-SET;
                next term;
            }
        }
    }
    policy-statement SET-COMMUNITY-GW5 {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                next policy;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                next policy;
            }
        }
        term set-gw-community {
            then {
                preference 169;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                community add BTMPLS-MD-GW5-SET;
                next term;
            }
        }
    }
    policy-statement SET-NEXT-HOP {
        term term-1 {
            from policy RED-CORE-DIVERSITY;
            then {
                next-hop 192.168.1.4;
                accept;
            }
        }
        term term-2 {
            from policy BLUE-CORE-DIVERSITY;
            then {
                next-hop 192.168.2.4;
                accept;
            }
        }
        term term-3 {
            then {
                next-hop self;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term 13-cascaded-mgmt {
            from {
                protocol static;
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                community set BT-MPLS-cascaded-mgmt-SET;
                accept;
            }
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA-GW1 {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                community add BTMPLS-MD-GW1-SET;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                community add BTMPLS-MD-GW1-SET;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA-GW2 {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                community add BTMPLS-MD-GW2-SET;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                community add BTMPLS-MD-GW2-SET;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA-GW3 {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                community add BTMPLS-MD-GW3-SET;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                community add BTMPLS-MD-GW3-SET;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA-GW4 {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                community add BTMPLS-MD-GW4-SET;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                community add BTMPLS-MD-GW4-SET;
                accept;
            }
        }
    }
    policy-statement SETLOCALPREFRA-GW5 {
        term tag-35 {
            from {
                protocol static;
                tag 35;
            }
            then reject;
        }
        term tag-101 {
            from {
                protocol static;
                tag 101;
            }
            then {
                local-preference 50;
                community add BTMPLS-MD-GW5-SET;
                accept;
            }
        }
        term static {
            from protocol static;
            then {
                local-preference 100;
                community add BTMPLS-MD-GW5-SET;
                accept;
            }
        }
    }
    policy-statement SETPELOCALPREFIN {
        term PE-VRF-loopback {
            from {
                prefix-list-filter ACL-8-loopback200 orlonger;
            }
            then reject;
        }
        term 30-bt-nmc-mgmt {
            from {
                prefix-list-filter ACL-30-bt-nmc-mgmt orlonger;
            }
            then reject;
        }
        term 11-CE-mgmt-loopback {
            from {
                prefix-list-filter ACL-11-CE-mgmt-loopbacks orlonger;
            }
            then {
                local-preference 25;
                community set BT-MPLS-CE-loopback-SET;
                accept;
            }
        }
        term 13-cascaded-mgmt {
            from {
                prefix-list-filter ACL-13-cascaded-mgmt orlonger;
            }
            then {
                local-preference 50;
                community set BT-MPLS-cascaded-mgmt-SET;
                accept;
            }
        }
        term set-local-pref {
            then {
                local-preference 50;
                community delete BT-MPLS-internal-wildcard;
                community delete UK-MPLS-internal-wildcard;
                community delete BT-MPLS-all-RTs;
                next term;
            }
        }
    }
    policy-statement Spanish-hub-policy {
        term Spanish-hub-rt {
            from community Spanish-hub-rt;
            then accept;
        }
    }
    policy-statement bgp-damping-policy {
        term always-damp {
            then {
                damping bgp-damping;
                accept;
            }
        }
    }
    policy-statement bgp-policies-RR-group-import {
        term call-damping-policy {
            from policy bgp-damping-policy;
            then next term;
        }
        term explicit-default-action {
            then next policy;
        }
    }
    policy-statement bgp-redistributes {
        term summary-only-aggregates-accept {
            from {
                protocol aggregate;
                route-filter 7.0.0.0/24 exact;
            }
            then accept;
        }
        term summary-only-aggregates-reject {
            from {
                route-filter 7.0.0.0/24 longer;
            }
            then reject;
        }
        term from-bgp {
            from protocol bgp;
            then next policy;
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement btgr-mgmt-hub-policy {
        term btgr-mgmt-hub-rt {
            from community btgr-mgmt-hub-rt;
            then accept;
        }
    }
    policy-statement btin-mgmt-hub-policy {
        term btin-mgmt-hub-rt {
            from community btin-mgmt-hub-rt;
            then accept;
        }
    }
    policy-statement btpolicy-mgnt-hub-policy {
        term btrt-mgnt-hub-rt {
            from community btrt-mgnt-hub-rt;
            then accept;
        }
    }
    policy-statement buda-shared-hub-policy {
        term buda-shared-hub-rt {
            from community buda-shared-hub-rt;
            then accept;
        }
    }
    policy-statement daf-red-blue {
        term 10 {
            from {
                route-filter 192.168.1.4/32 exact;
            }
            then accept;
        }
        term 20 {
            from {
                route-filter 192.168.2.4/32 exact;
            }
            then accept;
        }
    }
    policy-statement default-reject-all {
        then reject;
    }
    policy-statement dummy_vrf_export {
        term direct {
            from {
                protocol direct;
                policy CONNECTED-CONTAIN;
            }
            then {
                community add dummy_vrf_export_rt_set;
                accept;
            }
        }
    }
    policy-statement dummy_vrf_import {
        term bgp-routes {
            from {
                protocol bgp;
                community dummy_vrf_import_rt_set;
            }
            then accept;
        }
    }
    policy-statement grey_management_spoke_vrf_export {
        term direct {
            from protocol direct;
            then {
                community add grey_management_spoke_vrf_export_rt_set;
                accept;
            }
        }
        term bgp-routes {
            from protocol bgp;
            then {
                community add grey_management_spoke_vrf_export_rt_set;
                accept;
            }
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement grey_management_spoke_vrf_import {
        term bgp-routes {
            from {
                protocol bgp;
                community grey_management_spoke_vrf_import_rt_set;
            }
            then accept;
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement load-balancing-policy {
        then {
            load-balance per-packet;
        }
    }
    community Australasia-hub-rt members target:12641:1587;
    community Australasia-spoke-rt members target:12641:1539;
    community BT-MPLS-CE-loopback members "^12641:65050$";
    community BT-MPLS-CE-loopback-SET members 12641:65050;
    community BT-MPLS-NMC-mgmt members "^12641:65020$";
    community BT-MPLS-NMC-mgmt-SET members 12641:65020;
    community BT-MPLS-PE-CE-Interface members "^12641:6100$";
    community BT-MPLS-PE-CE-Interface-SET members 12641:6100;
    community BT-MPLS-PE-VRF-loopback members "^12641:65010$";
    community BT-MPLS-PE-VRF-loopback-SET members 12641:65010;
    community BT-MPLS-all-RTs members "target:(12641|2856):.*";
    community BT-MPLS-all-wildcard members 12641:.*;
    community BT-MPLS-blue-core-active members "^12641:6121$";
    community BT-MPLS-blue-core-active-SET members 12641:6121;
    community BT-MPLS-blue-core-diverse members "^12641:6123$";
    community BT-MPLS-blue-core-diverse-SET members 12641:6123;
    community BT-MPLS-cascaded-mgmt members "^12641:65055$";
    community BT-MPLS-cascaded-mgmt-SET members 12641:65055;
    community BT-MPLS-customer-prefixes members "^12641:[8-9]...$";
    community BT-MPLS-internal-wildcard members "^12641:([1-57-9].*|6.{0,2}|6.{4,})$";
    community BT-MPLS-red-core-active members "^12641:6122$";
    community BT-MPLS-red-core-active-SET members 12641:6122;
    community BT-MPLS-red-core-diverse members "^12641:6124$";
    community BT-MPLS-red-core-diverse-SET members 12641:6124;
    community BT-MPLS-routes-wildcard members "^12641:650..$";
    community BTMPLS-MD-GW1 members "^12641:9350$";
    community BTMPLS-MD-GW1-SET members 12641:9350;
    community BTMPLS-MD-GW2 members "^12641:9351$";
    community BTMPLS-MD-GW2-SET members 12641:9351;
    community BTMPLS-MD-GW3 members "^12641:9352$";
    community BTMPLS-MD-GW3-SET members 12641:9352;
    community BTMPLS-MD-GW4 members "^12641:9353$";
    community BTMPLS-MD-GW4-SET members 12641:9353;
    community BTMPLS-MD-GW5 members "^12641:9354$";
    community BTMPLS-MD-GW5-SET members 12641:9354;
    community Belgium-hub-rt members target:12641:448;
    community Belgium-spoke-rt members target:12641:449;
    community CONNECTED-CONTAIN-1 members 12641:65010;
    community France-hub-rt members target:12641:1634;
    community France-spoke-rt members target:12641:1635;
    community GCSC-Amsterdam-hub-rt members target:12641:520;
    community GCSC-Amsterdam-spoke-rt members target:12641:521;
    community INTGW-A-AMH-EU members "^12641:1101$";
    community INTGW-A-AMH-EU-SET members 12641:1101;
    community INTGW-A-SGP-AP members "^12641:1106$";
    community INTGW-A-SGP-AP-SET members 12641:1106;
    community INTGW-A-SNJ-US members "^12641:1103$";
    community INTGW-A-SNJ-US-SET members 12641:1103;
    community INTGW-A-SPT-AP members "^12641:1107$";
    community INTGW-A-SPT-AP-SET members 12641:1107;
    community INTGW-A-STI-US members "^12641:1102$";
    community INTGW-A-STI-US-SET members 12641:1102;
    community INTGW-A-TFP-EU members "^12641:1100$";
    community INTGW-A-TFP-EU-SET members 12641:1100;
    community INTGW-B-FRK-EU members "^12641:1104$";
    community INTGW-B-FRK-EU-SET members 12641:1104;
    community INTGW-B-STK-EU members "^12641:1105$";
    community INTGW-B-STK-EU-SET members 12641:1105;
    community Irish-hub-rt members target:12641:530;
    community Irish-spoke-rt members target:12641:531;
    community NAMngt-hub-rt members target:12641:808;
    community NAMngt-spoke-rt members target:12641:809;
    community Netherlands-mgnt-hub-rt members target:12641:464;
    community Netherlands-spoke-rt members target:12641:465;
    community Reuters-NAT members "^16579:3001$";
    community Reuters-NAT-SET members 16579:3001;
    community Reuters-Spring members "^30240:6001$";
    community Spanish-hub-rt members target:12641:976;
    community Spanish-spoke-rt members target:12641:977;
    community UK-MPLS-PE-VRF-loopback members "^2856:65010$";
    community UK-MPLS-PE-VRF-loopback-SET members 2856:65010;
    community UK-MPLS-all-wildcard members 2856:.*;
    community UK-MPLS-customer-prefixes members "^2856:[8-9]...$";
    community UK-MPLS-internal-wildcard members "^2856:([1-57-9].*|6.{0,2}|6.{4,})$";
    community UK-MPLS-routes-wildcard members "^2856:650..$";
    community all-BT-Origins members "origin:(12641|2856):.*";
    community all-Origins members origin:.*:.*;
    community all-RTs members target:.*:.*;
    community btgr-mgmt-hub-rt members target:12641:326;
    community btgr-mgmt-spoke-rt members target:12641:327;
    community btin-mgmt-hub-rt members target:12641:256;
    community btin-mgmt-spoke-rt members target:12641:257;
    community btrt-mgnt-hub-rt members target:12641:370;
    community btrt-mgnt-spoke-rt members target:12641:371;
    community buda-shared-hub-rt members target:12641:9243;
    community buda-shared-spoke-rt members target:12641:9244;
    community community-BLUE-CORE-DIVERSITY-1 members 2856:6123;
    community community-BLUE-CORE-DIVERSITY-2 members 12641:6123;
    community community-RED-CORE-DIVERSITY-1 members 2856:6124;
    community community-RED-CORE-DIVERSITY-2 members 12641:6124;
    community dummy_vrf_export_rt_set members target:12641:9037;
    community dummy_vrf_import_rt_set members target:12641:9037;
    community grey_management_spoke_vrf_export_rt_set members target:12641:1;
    community grey_management_spoke_vrf_import_rt_set members target:12641:1;
    damping bgp-damping {
        half-life 1;
        reuse 1500;
        suppress 4100;
        max-suppress 4;
    }
}
class-of-service {
    classifiers {
        exp BT_mpls_core_exp_ba_classifier {
            forwarding-class FC-Q5 {
                loss-priority low code-points 100;
            }
            forwarding-class FC-Q6 {
                loss-priority low code-points 110;
                loss-priority high code-points 010;
            }
            forwarding-class FC-Q4 {
                loss-priority low code-points 101;
                loss-priority high code-points [ 001 011 111 ];
            }
            forwarding-class FC-EXP0-Q4 {
                loss-priority high code-points 000;
            }
        }
        inet-precedence BT_mpls_core_prec_ba_classifier {
            forwarding-class FC-Q6 {
                loss-priority low code-points 110;
                loss-priority high code-points [ 010 100 ];
            }
            forwarding-class FC-Q4 {
                loss-priority low code-points [ 000 101 111 ];
                loss-priority high code-points 001;
            }
            forwarding-class FC-Q7 {
                loss-priority low code-points 011;
            }
        }
    }
    host-outbound-traffic {
        forwarding-class FC-Q3;
        dscp-code-point 110000;
    }
    drop-profiles {
        general_in-contract_drop_profile {
            interpolate {
                fill-level [ 62 99 100 ];
                drop-probability [ 0 10 100 ];
            }
        }
        general_out-contract_drop_profile {
            interpolate {
                fill-level [ 19 50 51 ];
                drop-probability [ 0 20 100 ];
            }
        }
        general_DPC-in-contract_drop_profile {
            fill-level 62 drop-probability 0;
            fill-level 99 drop-probability 10;
        }
        general_DPC-out-contract_drop_profile {
            fill-level 19 drop-probability 0;
            fill-level 50 drop-probability 20;
        }
        general_IQ2-in-contract_drop_profile {
            fill-level 62 drop-probability 0;
            fill-level 99 drop-probability 10;
        }
        general_IQ2-out-contract_drop_profile {
            fill-level 19 drop-probability 0;
            fill-level 50 drop-probability 20;
        }
        traffic-in-contract-drop-profile {
            fill-level 62 drop-probability 0;
            fill-level 99 drop-probability 10;
        }
        traffic-out-contract-drop-profile {
            fill-level 19 drop-probability 0;
            fill-level 50 drop-probability 20;
        }
        IQE-traffic-in-contract-drop-profile {
            interpolate {
                fill-level [ 62 99 100 ];
                drop-probability [ 0 10 100 ];
            }
        }
        IQE-traffic-out-contract-drop-profile {
            interpolate {
                fill-level [ 19 50 51 ];
                drop-probability [ 0 20 100 ];
            }
        }
        chassis-traffic-in-contract-drop-profile {
            interpolate {
                fill-level [ 62 99 100 ];
                drop-probability [ 0 10 100 ];
            }
        }
        chassis-traffic-out-contract-drop-profile {
            interpolate {
                fill-level [ 19 50 51 ];
                drop-probability [ 0 20 100 ];
            }
        }
    }
    forwarding-classes {
        class FC-Q0 queue-num 0;
        class FC-Q1 queue-num 1;
        class FC-Q2 queue-num 2;
        class FC-Q3 queue-num 3;
        class FC-Q4 queue-num 4;
        class FC-Q5 queue-num 5;
        class FC-Q6 queue-num 6;
        class FC-Q7 queue-num 7;
        class FC-EXP0-Q4 queue-num 4;
        class FC-Q4-Bleach queue-num 4;
    }
    routing-instances {
        all {
            classifiers {
                exp BT_mpls_core_exp_ba_classifier;
            }
        }
    }
    rewrite-rules {
        dscp BT_mpls_core_dscp_rewrite {
            forwarding-class FC-Q4-Bleach {
                loss-priority low code-point 000000;
            }
        }
        exp BT_mpls_core_exp_rewrite {
            forwarding-class FC-Q4 {
                loss-priority low code-point 101;
                loss-priority high code-point 001;
            }
            forwarding-class FC-Q5 {
                loss-priority low code-point 100;
            }
            forwarding-class FC-Q6 {
                loss-priority low code-point 110;
                loss-priority high code-point 010;
            }
            forwarding-class FC-EXP0-Q4 {
                loss-priority high code-point 000;
            }
            forwarding-class FC-Q4-Bleach {
                loss-priority low code-point 101;
            }
        }
    }
    scheduler-maps {
        scheduler_map_chassis_1Gbps_cpa_cppc {
            forwarding-class FC-Q5 scheduler Class_EF_1Gbps_cpa_cppc_71percent;
            forwarding-class FC-Q6 scheduler Class_AF4_1Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q7 scheduler Class_AF3_1Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q2 scheduler Class_AF2_1Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q1 scheduler Class_AF1_1Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q4 scheduler Class_BE_1Gbps_cpa_cppc_3percent;
            forwarding-class FC-Q3 scheduler Class_Cntrl_1Gbps_cpa_cppc_1percent;
            forwarding-class FC-Q0 scheduler Class_Mgmt_1Gbps_cpa_cppc_1percent;
        }
        scheduler_map_chassis_10Gbps_cpa_cppc {
            forwarding-class FC-Q5 scheduler Class_EF_10Gbps_cpa_cppc_71percent;
            forwarding-class FC-Q6 scheduler Class_AF4_10Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q7 scheduler Class_AF3_10Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q2 scheduler Class_AF2_10Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q1 scheduler Class_AF1_10Gbps_cpa_cppc_6percent;
            forwarding-class FC-Q4 scheduler Class_BE_10Gbps_cpa_cppc_3percent;
            forwarding-class FC-Q3 scheduler Class_Cntrl_10Gbps_cpa_cppc_1percent;
            forwarding-class FC-Q0 scheduler Class_Mgmt_10Gbps_cpa_cppc_1percent;
        }
        scheduler_map_chassis_leased_line_cpa_cppc {
            forwarding-class FC-Q0 scheduler Class_Mgmt_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q3 scheduler Class_Cntrl_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q5 scheduler Class_EF_leased_line_cpa_cppc_92percent;
            forwarding-class FC-Q6 scheduler Class_AF4_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q7 scheduler Class_AF3_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q2 scheduler Class_AF2_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q1 scheduler Class_AF1_leased_line_cpa_cppc_1percent;
            forwarding-class FC-Q4 scheduler Class_BE_leased_line_cpa_cppc_1percent;
        }
    }
    schedulers {
        DPC-core_cntrl {
            transmit-rate percent 3;
            buffer-size temporal 100k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile general_DPC-in-contract_drop_profile;
            drop-profile-map loss-priority high protocol any drop-profile general_DPC-out-contract_drop_profile;
        }
        DPC-core_cntrl_chassis {
            transmit-rate percent 3;
            buffer-size temporal 100k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile general_in-contract_drop_profile;
            drop-profile-map loss-priority high protocol any drop-profile general_out-contract_drop_profile;
        }
        Class_EF_1Gbps_cpa_cppc_71percent {
            transmit-rate percent 71 rate-limit;
            priority high;
        }
        Class_Cntrl_1Gbps_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 100k;
            priority low;
        }
        Class_Mgmt_1Gbps_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 100k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
        }
        Class_AF4_1Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 13380;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF3_1Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 13380;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF2_1Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 13380;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF1_1Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 13380;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_BE_1Gbps_cpa_cppc_3percent {
            transmit-rate percent 3;
            buffer-size temporal 37840;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_EF_10Gbps_cpa_cppc_71percent {
            transmit-rate percent 71 rate-limit;
            priority high;
        }
        Class_Cntrl_10Gbps_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 100k;
            priority low;
        }
        Class_Mgmt_10Gbps_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 100k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
        }
        Class_AF4_10Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 4300;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF3_10Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 4300;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF2_10Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 4300;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF1_10Gbps_cpa_cppc_6percent {
            transmit-rate percent 6;
            buffer-size temporal 4300;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_BE_10Gbps_cpa_cppc_3percent {
            transmit-rate percent 3;
            buffer-size temporal 11970;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_Mgmt_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 1k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
        }
        Class_Cntrl_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 1k;
            priority low;
        }
        Class_EF_leased_line_cpa_cppc_92percent {
            transmit-rate percent 92 rate-limit;
            priority high;
        }
        Class_AF4_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 5k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF3_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 5k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF2_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 5k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_AF1_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 5k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-in-contract-drop-profile;
            drop-profile-map loss-priority high protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
        Class_BE_leased_line_cpa_cppc_1percent {
            transmit-rate percent 1;
            buffer-size temporal 10k;
            priority low;
            drop-profile-map loss-priority low protocol any drop-profile chassis-traffic-out-contract-drop-profile;
        }
    }
}
firewall {
    family inet {
        filter RSVP-rate-limit {
            term rsvp {
                from {
                    protocol rsvp;
                }
                then {
                    policer rsvp-policer;
                    accept;
                }
            }
            term match-all {
                then accept;
            }
        }
        filter protect-RE {
            term first-frag {
                from {
                    first-fragment;
                }
                then {
                    count first-frag;
                    discard;
                }
            }
            term next-frag {
                from {
                    is-fragment;
                }
                then {
                    count next-frag;
                    discard;
                }
            }
            term tcp-invalid-flags {
                from {
                    protocol tcp;
                    tcp-flags "syn & fin";
                }
                then {
                    count tcp-invalid-flags;
                    discard;
                }
            }
            term tcp-dos-protection {
                from {
                    protocol tcp;
                    tcp-flags "(syn & !ack) | fin | rst";
                }
                then {
                    policer tcp-connection-policer;
                    count tcp-syn;
                    next term;
                }
            }
            term telnet-in {
                from {
                    source-prefix-list {
                        telnet-addresses;
                    }
                    protocol tcp;
                    destination-port [ telnet ftp ];
                }
                then {
                    policer telnet-policer;
                    accept;
                }
            }
            term telnet-out {
                from {
                    protocol tcp;
                    source-port [ telnet ftp ];
                    tcp-established;
                }
                then accept;
            }
            term ftp {
                from {
                    source-prefix-list {
                        ftp-addresses;
                    }
                    protocol tcp;
                    port [ ftp ftp-data ];
                }
                then {
                    policer ftp-policer;
                    count ftp;
                    accept;
                }
            }
            term ospf {
                from {
                    protocol ospf;
                }
                then {
                    count ospf-traffic;
                    accept;
                }
            }
            term ldp {
                from {
                    protocol [ tcp udp ];
                    port ldp;
                }
                then {
                    count ldp-traffic;
                    accept;
                }
            }
            term ldp-ping {
                from {
                    protocol udp;
                    port 3503;
                }
                then {
                    count ldp-ping-traffic;
                    accept;
                }
            }
            term pim {
                from {
                    protocol pim;
                }
                then {
                    count pim-traffic;
                    accept;
                }
            }
            term bgp {
                from {
                    protocol tcp;
                    port bgp;
                }
                then {
                    count bgp;
                    accept;
                }
            }
            term bfd {
                from {
                    protocol udp;
                    destination-port 3784-3785;
                }
                then {
                    count bfd-traffic;
                    accept;
                }
            }
            term rsvp {
                from {
                    protocol rsvp;
                }
                then {
                    count rsvp-traffic;
                    accept;
                }
            }
            term snmp {
                from {
                    source-prefix-list {
                        snmp-addresses;
                    }
                    protocol udp;
                    destination-port snmp;
                }
                then {
                    policer snmp-policer;
                    count snmp-count;
                    accept;
                }
            }
            term ntp {
                from {
                    source-prefix-list {
                        ntp-addresses;
                    }
                    protocol udp;
                    port ntp;
                }
                then {
                    policer ntp-policer;
                    count ntp;
                    accept;
                }
            }
            term dns {
                from {
                    source-prefix-list {
                        dns-addresses;
                    }
                    protocol udp;
                    source-port domain;
                }
                then {
                    policer dns-policer;
                    count dns;
                    accept;
                }
            }
            term tacacs {
                from {
                    source-prefix-list {
                        tacacs-addresses;
                    }
                    protocol tcp;
                    source-port tacacs;
                }
                then {
                    policer tacacs-policer;
                    count tacacs;
                    accept;
                }
            }
            term traceroute {
                from {
                    protocol udp;
                    destination-port 33434-33523;
                }
                then {
                    count traceroute-traffic;
                    accept;
                }
            }
            term icmp {
                from {
                    protocol icmp;
                    icmp-type [ echo-request echo-reply unreachable time-exceeded ];
                }
                then {
                    policer small-bw-policer;
                    count icmp-traffic;
                    accept;
                }
            }
            term lab-ssh {
                from {
                    prefix-list {
                        ssh-addresses;
                    }
                    protocol tcp;
                    port ssh;
                }
                then {
                    count ssh;
                    accept;
                }
            }
            term lab-radius {
                from {
                    prefix-list {
                        ssh-addresses;
                    }
                    protocol udp;
                    port [ 1812 1813 ];
                }
                then {
                    count radius;
                    accept;
                }
            }
            term discard-everything-else {
                then {
                    count deny-everything-else;
                    log;
                    discard;
                }
            }
        }
        filter protect-RE-VRF {
            term first-frag {
                from {
                    first-fragment;
                }
                then {
                    count first-frag;
                    discard;
                }
            }
            term next-frag {
                from {
                    is-fragment;
                }
                then {
                    count next-frag;
                    discard;
                }
            }
            term allow-bfd {
                from {
                    protocol udp;
                    port [ 3784-3785 4784 ];
                }
                then {
                    count bfd-traffic;
                    accept;
                }
            }
            term allow-bgp-established {
                from {
                    protocol tcp;
                    source-port bgp;
                    tcp-established;
                }
                then {
                    count bgp-traffic;
                    accept;
                }
            }
            term allow-traceroute {
                from {
                    protocol udp;
                    destination-port 33434-33523;
                }
                then {
                    policer small-bw-policer-access;
                    count traceroute-traffic;
                    accept;
                }
            }
            term allow-icmp {
                from {
                    protocol icmp;
                    icmp-type [ echo-request echo-reply ];
                }
                then {
                    policer small-bw-policer-access;
                    count icmp-traffic;
                    accept;
                }
            }
            term allow-radius {
                from {
                    protocol udp;
                    source-port [ 1645 1812 ];
                    destination-port 1024-49151;
                }
                then {
                    count radius-traffic;
                    accept;
                }
            }
            term allow-vrrp {
                from {
                    protocol vrrp;
                }
                then {
                    count vrrp-traffic;
                    accept;
                }
            }
            term explicit-deny {
                then {
                    count all-other-traffic;
                    log;
                    discard;
                }
            }
        }
        filter input-filter-bun-unn {
            interface-specific;
            term non-icmp-tcp-udp {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol-except [ icmp tcp udp ];
                }
                then {
                    discard;
                }
            }
            term not-radius-to-lo0s-part1 {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol udp;
                    source-port-except [ 1645 1812 ];
                }
                then {
                    count rejected-not-radius-part1;
                    discard;
                }
            }
            term not-radius-to-lo0s-part2 {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol udp;
                    destination-port-except 1024-49151;
                }
                then {
                    count rejected-not-radius-part2;
                    discard;
                }
            }
            term not-bgp-to-lo0s-PE {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol tcp;
                    source-port-except bgp;
                    destination-port-except bgp;
                }
                then {
                    count rejected-not-bgp;
                    discard;
                }
            }
            term radius {
                from {
                    protocol udp;
                    source-port [ 1645 1812 ];
                    destination-port 1024-49151;
                }
                then {
                    count radius;
                    next term;
                }
            }
            term last-accept {
                then next term;
            }
        }
        filter input-filter-unb-unn {
            interface-specific;
            term denied-unb-unn-src-n-dst {
                from {
                    prefix-list {
                        ams-mgt-addr;
                        ams-mgt2-addr;
                        tfp-mgt-addr;
                        ble-mgt-addr;
                        atl-sdm-addr;
                        tacacs-server1;
                        tacacs-server2;
                        deny-unb-unn-src-n-dst;
                    }
                }
                then {
                    count deny-unb-unn-src-n-dst;
                    discard;
                }
            }
            term denied-unb-unn-as-dst {
                from {
                    destination-prefix-list {
                        deny-unb-unn-dst;
                    }
                }
                then {
                    count deny-unb-unn-as-dst;
                    discard;
                }
            }
            term non-icmp-tcp-udp {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol-except [ icmp tcp udp ];
                }
                then {
                    discard;
                }
            }
            term not-radius-to-lo0s-part1 {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol udp;
                    source-port-except [ 1645 1812 ];
                }
                then {
                    count rejected-not-radius-part1;
                    discard;
                }
            }
            term not-radius-to-lo0s-part2 {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol udp;
                    destination-port-except 1024-49151;
                }
                then {
                    count rejected-not-radius-part2;
                    discard;
                }
            }
            term not-bgp-to-lo0s-PE {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                    protocol tcp;
                    source-port-except bgp;
                    destination-port-except bgp;
                }
                then {
                    count rejected-not-bgp;
                    discard;
                }
            }
            term radius {
                from {
                    protocol udp;
                    source-port [ 1645 1812 ];
                    destination-port 1024-49151;
                }
                then {
                    count radius;
                    next term;
                }
            }
            term last-accept {
                then next term;
            }
        }
        filter input-filter-bun-num {
            interface-specific;
            term permit-icmp {
                from {
                    protocol icmp;
                }
                then {
                    policer small-bw-policer-access;
                    count icmp-traffic;
                    next term;
                }
            }
            term permit-bgp {
                from {
                    protocol tcp;
                    port bgp;
                }
                then {
                    count bgp-traffic;
                    next term;
                }
            }
            term permit-bfd {
                from {
                    protocol udp;
                    port 3784-3785;
                }
                then {
                    count bfd-traffic;
                    next term;
                }
            }
            term permit-vrrp {
                from {
                    destination-address {
                        224.0.0.18/32;
                    }
                    protocol vrrp;
                }
                then {
                    count vrrp-traffic;
                    next term;
                }
            }
            term permit-RADIUS {
                from {
                    protocol udp;
                    source-port [ 1645 1812 ];
                    destination-port 1024-49151;
                }
                then {
                    count radius-traffic;
                    next term;
                }
            }
            term permit-bootps {
                from {
                    protocol udp;
                    source-port bootps;
                    destination-port bootps;
                }
                then {
                    count bootps-traffic;
                    next term;
                }
            }
            term deny-to-pe-loopbacks {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                }
                then {
                    count reject-lo200;
                    discard;
                }
            }
            term next-term {
                then {
                    count all-other-traffic;
                    next term;
                }
            }
        }
        filter input-filter-unb-num {
            interface-specific;
            term denied-unb-unn-src-n-dst {
                from {
                    prefix-list {
                        ams-mgt-addr;
                        ams-mgt2-addr;
                        tfp-mgt-addr;
                        ble-mgt-addr;
                        atl-sdm-addr;
                        tacacs-server1;
                        tacacs-server2;
                        deny-unb-unn-src-n-dst;
                    }
                }
                then {
                    count deny-unb-unn-src-n-dst;
                    discard;
                }
            }
            term denied-unb-unn-as-dst {
                from {
                    destination-prefix-list {
                        deny-unb-unn-dst;
                    }
                }
                then {
                    count deny-unb-unn-dst;
                    discard;
                }
            }
            term permit-icmp {
                from {
                    protocol icmp;
                }
                then {
                    policer small-bw-policer-access;
                    count icmp-traffic;
                    next term;
                }
            }
            term permit-bgp {
                from {
                    protocol tcp;
                    port bgp;
                }
                then {
                    count bgp-traffic;
                    next term;
                }
            }
            term permit-bfd {
                from {
                    protocol udp;
                    port 3784-3785;
                }
                then {
                    count bfd-traffic;
                    next term;
                }
            }
            term permit-vrrp {
                from {
                    destination-address {
                        224.0.0.18/32;
                    }
                    protocol vrrp;
                }
                then {
                    count vrrp-traffic;
                    next term;
                }
            }
            term permit-RADIUS {
                from {
                    protocol udp;
                    source-port [ 1645 1812 ];
                    destination-port 1024-49151;
                }
                then {
                    count radius-traffic;
                    next term;
                }
            }
            term permit-bootps {
                from {
                    protocol udp;
                    source-port bootps;
                    destination-port bootps;
                }
                then {
                    count bootps-traffic;
                    next term;
                }
            }
            term deny-to-pe-loopbacks {
                from {
                    destination-prefix-list {
                        ACL-8-loopback200;
                    }
                }
                then {
                    count reject-lo200;
                    discard;
                }
            }
            term next-term {
                then {
                    count all-other-traffic;
                    next term;
                }
            }
        }
    }
    policer dns-policer {
        if-exceeding {
            bandwidth-limit 500k;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer ftp-policer {
        if-exceeding {
            bandwidth-limit 2m;
            burst-size-limit 256k;
        }
        then discard;
    }
    policer ntp-policer {
        if-exceeding {
            bandwidth-limit 250k;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer rsvp-policer {
        if-exceeding {
            bandwidth-limit 100k;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer bgp-policer {
        if-exceeding {
            bandwidth-limit 10m;
            burst-size-limit 2m;
        }
        then discard;
    }
    policer small-bw-policer {
        if-exceeding {
            bandwidth-limit 10m;
            burst-size-limit 2m;
        }
        then discard;
    }
    policer snmp-policer {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer tacacs-policer {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer telnet-policer {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 128k;
        }
        then discard;
    }
    policer tcp-connection-policer {
        if-exceeding {
            bandwidth-limit 50k;
            burst-size-limit 15k;
        }
        then discard;
    }
    policer small-bw-policer-access {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 31500;
        }
        then discard;
    }
}
routing-instances {
    blue {
        instance-type no-forwarding;
        interface ge-9/0/5.75;
        interface ge-9/0/6.75;
        routing-options {
            interface-routes {
                rib-group inet daf-blue;
            }
            static {
                route 192.168.2.4/32 receive;
            }
            router-id 192.168.2.4;
        }
        protocols {
            ospf {
                spf-options {
                    delay 8000;
                    holddown 20000;
                    rapid-runs 3;
                }
                rib-group daf-blue;
                export daf-red-blue;
                area 0.0.0.5 {
                    interface ge-9/0/6.75 {
                        interface-type p2p;
                        metric 10;
                        priority 0;
                        ldp-synchronization;
                        hello-interval 10;
                        dead-interval 40;
                        authentication {
                            md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                        }
                    }
                    interface ge-9/0/5.75 {
                        interface-type p2p;
                        metric 10;
                        priority 0;
                        ldp-synchronization;
                        hello-interval 10;
                        dead-interval 40;
                        authentication {
                            md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                        }
                    }
                }
            }
        }
    }
    dummy {
        instance-type vrf;
        interface lo0.200;
        route-distinguisher 12641:1;
        vrf-import dummy_vrf_import;
        vrf-export dummy_vrf_export;
    }
    grey_management_spoke_vrf {
        instance-type vrf;
        route-distinguisher 12641:310001;
        vrf-import grey_management_spoke_vrf_import;
        vrf-export grey_management_spoke_vrf_export;
    }
    red {
        instance-type no-forwarding;
        interface ge-9/0/5.65;
        interface ge-9/0/6.65;
        routing-options {
            interface-routes {
                rib-group inet daf-red;
            }
            static {
                route 192.168.1.4/32 receive;
            }
            router-id 192.168.1.4;
        }
        protocols {
            ospf {
                spf-options {
                    delay 8000;
                    holddown 20000;
                    rapid-runs 3;
                }
                rib-group daf-red;
                export daf-red-blue;
                area 0.0.0.5 {
                    interface ge-9/0/6.65 {
                        interface-type p2p;
                        metric 10;
                        priority 0;
                        ldp-synchronization;
                        hello-interval 10;
                        dead-interval 40;
                        authentication {
                            md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                        }
                    }
                    interface ge-9/0/5.65 {
                        interface-type p2p;
                        metric 10;
                        priority 0;
                        ldp-synchronization;
                        hello-interval 10;
                        dead-interval 40;
                        authentication {
                            md5 1 key "$9$chCrK8-VYZUHX7UHqmF3SrevX7dbs4JG" start-time "2010-1-1.00:00:00 +0000"; ## SECRET-DATA
                        }
                    }
                }
            }
        }
    }
}
