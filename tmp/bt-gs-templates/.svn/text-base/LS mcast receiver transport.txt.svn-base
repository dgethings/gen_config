interfaces {
    $physical_interface$  {
        description "$physical_interface_description$";
        traps;
        vlan-tagging;
        hierarchical-scheduler;
        mtu 1518;
        hold-time up 2000 down 2000;
        unit $logical_interface$ {
            description $subinterface_description$;
            vlan-id $vlan$;
            family inet {
                mtu 1500;
                address $ip_address$/30;
            }
        }
    }
    lo0 {
        unit $vrf_lo0_logical_int$ {
            description "$vrf_lo0_int_descr$";
            family inet {
                address $dummy_ip_address$/32;
                address $vrf_lo0_ip_addr$/32  {
                    primary;
                    preferred;
                }
            }
        }
    }
}
policy-options {
    community $transport_vrf_import_rt_set_1$ members target:12641:$Provider_VPN_RT$;
    community $transport_vrf_import_rt_set_2$ members target:12641:$Provider_RP_RT$;
    policy-statement $transport_vrf_import_policy$ {
        term VPN-routes {
            from {
                protocol bgp;
                community $transport_vrf_import_rt_set_1$;
            }
            then accept;
        }
        term RP {
            from {
                protocol bgp;
                community $transport_vrf_import_rt_set_2$;
            }
            then accept;
        }
        term mdt {
            from {
                family inet-mdt;
                protocol bgp;
                route-filter $default_MDT_group_address$/32 exact;
                route-filter $data_MDT_group_address$/32 exact;
            }
            then accept;
        }
        term explicit-deny {
            then reject;
        }
    }
    policy-statement $transport_vrf_export_policy$ {
        term rib-mdt {
            from rib $transport_vrf_name$.mdt.0;
            then {
                accept;
            }
        }
        term explicit-deny {
            then reject;
        }
    }
}
routing-instances {
    $transport_vrf_name$ {
        instance-type vrf;
        interface $physical_interface$.$logical_interface$;
        route-distinguisher 12641:$RD$;
        vrf-import $transport_vrf_import_policy$;
        vrf-export $transport_vrf_export_policy$;
        vrf-table-label;
        provider-tunnel {
            pim-ssm {
                group-address $default_MDT_group_address$;
            }
        }
        protocols {
            pim {
                mvpn {
                    autodiscovery {
                        inet-mdt;
                    }
                }
                rp {
                    static {
                        address $RP_address$ {
                             group-ranges {
                               $customer_multicast_group_address$/32;
                            }
                        }
                    }
                }
            }
            mvpn {
                autodiscovery-only {
                    intra-as {
                        inclusive;
                    }
                }
            }
        }
    }
}
