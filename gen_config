#!/usr/bin/env ruby
require 'erb'
require 'yaml'
require 'ostruct'

unless ARGV[0]
  puts "Usage : #{$0} <YAML_FILE> [test]"
  puts "\t[test] is optional, if set output will be the YAML configuration"
  exit
end

yaml = YAML.load_file( ARGV[0] )

template = ERB.new( File.read( ARGV[1] ) )
c = OpenStruct.new( yaml )

puts template.result( c.send( :binding ) )
